<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ðŸ“š Book Inventory with Backup</title>
<style>
* { box-sizing: border-box; margin: 0; padding: 0; }
body { 
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
  background: #f5f7fa; 
  display: flex; 
  flex-direction: column; 
  align-items: center; 
  padding: 20px; 
  min-height: 100vh; 
}
h1 { color: #333; margin-bottom: 20px; font-size: 2rem; }
.input-container, .category-tools { 
  width: 100%; max-width: 600px; background: #fff; padding: 20px; border-radius: 12px; 
  box-shadow: 0 4px 10px rgba(0,0,0,0.05); margin-bottom: 20px; display: flex; flex-direction: column; gap: 10px; 
}
input, select, button { padding: 12px; font-size: 1rem; border-radius: 8px; border: 1px solid #ccc; }
input:focus, select:focus { outline: none; border-color: #4CAF50; }
button { cursor: pointer; background-color: #4CAF50; color: #fff; border: none; transition: 0.3s; border-radius: 8px; }
button:hover { background-color: #45a049; }
button.secondary { background-color: #f44336; } button.secondary:hover { background-color: #e53935; }
button.info { background-color: #2196F3; } button.info:hover { background-color: #1976D2; }
button.warning { background-color: #FF9800; } button.warning:hover { background-color: #F57C00; }
.table-container { width: 100%; max-width: 700px; overflow-x: auto; }
table { width: 100%; border-collapse: collapse; background: #fff; border-radius: 12px; overflow: hidden; box-shadow: 0 4px 10px rgba(0,0,0,0.05); min-width: 500px; }
th, td { padding: 14px 12px; text-align: left; border-bottom: 1px solid #eee; white-space: nowrap; }
th { background-color: #f4f6f8; font-weight: 600; }
.delete-btn { background-color: #f44336; color: white; border: none; padding: 6px 12px; border-radius: 6px; cursor: pointer; transition: 0.3s; }
.delete-btn:hover { background-color: #e53935; }
#totalBooks { margin-top: 15px; font-weight: bold; font-size: 1.2rem; color: #333; text-align: center; }

/* Responsive custom file input */
.file-input-wrapper {
  display: flex;
  align-items: center;
  gap: 10px;
  flex-wrap: wrap;
}
.file-input-wrapper label {
  background: #FF9800;
  color: #fff;
  padding: 10px 16px;
  border-radius: 8px;
  cursor: pointer;
  transition: 0.3s;
  white-space: nowrap;
}
.file-input-wrapper label:hover {
  background: #F57C00;
}
#fileName {
  font-size: 0.9rem;
  color: #555;
  max-width: 200px;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}
#importFile { display: none; }

/* Responsive layout improvements */
@media(max-width: 650px){
  .input-container, .category-tools, .table-container { width: 95%; }
  th, td { font-size: 0.9rem; padding: 10px; }
  input, select, button { font-size: 0.9rem; padding: 10px; }
  #fileName { max-width: 100%; }
  /* Make restore section stack */
  .restore-controls {
    flex-direction: column;
    align-items: stretch;
  }
  .restore-controls select,
  .restore-controls button {
    width: 100%;
  }
}
</style>
</head>
<body>
<h1>ðŸ“š Book Inventory with Backup</h1>

<div class="input-container">
  <input type="text" id="bookName" placeholder="Enter book name">
  <input type="number" id="bookAmount" placeholder="Enter amount">
  <select id="bookCategory">
    <option value="">Select Category</option>
    <option>1st SEM</option>
    <option>3rd SEM</option>
    <option>5th SEM</option>
    <option>7th SEM</option>
    <option>Other</option>
  </select>
  <div style="display:flex; gap:10px; flex-wrap:wrap;">
    <button id="addBtn">Add Book</button>
    <button id="clearAllBtn" class="secondary">Clear All Books</button>
    <button id="exportBtn" class="info">Export CSV</button>
    
    <!-- FIXED RESPONSIVE FILE INPUT -->
    <div class="file-input-wrapper">
      <label for="importFile">Choose CSV</label>
      <span id="fileName">No file chosen</span>
      <input type="file" id="importFile" accept=".csv">
    </div>
    
    <button id="importBtn" class="warning">Import CSV</button>
    <button id="backupBtn" class="info">Backup Now</button>
  </div>

  <!-- Restore + Delete Backup now grouped -->
  <div class="restore-controls" style="display:flex; gap:10px; flex-wrap:wrap; margin-top:10px;">
    <select id="restoreSelect"></select>
    <button id="restoreBtn" class="warning">Restore Backup</button>
    <button id="deleteBackupBtn" class="secondary">Delete Backup</button>
  </div>
</div>

<div class="category-tools">
  <label><b>Filter:</b></label>
  <select id="filterCategory"><option value="All">All</option></select>
  <label><b>Search:</b></label>
  <input type="text" id="searchBox" placeholder="Search...">
</div>

<!-- TABLE IS NOW WRAPPED FOR SCROLL -->
<div class="table-container">
  <table id="bookTable">
    <thead>
      <tr><th>Name</th><th>Amount</th><th>Category</th><th>Actions</th></tr>
    </thead>
    <tbody></tbody>
  </table>
</div>

<div id="totalBooks">Total Books: 0</div>

<script type="module">
// (âš¡ all your Firebase logic, add, clear, import, export, backup, restore, delete backup, render stays unchanged)
// Only addition was: fileName display handler
document.getElementById("importFile").addEventListener("change", e=>{
  const fileName = e.target.files.length ? e.target.files[0].name : "No file chosen";
  document.getElementById("fileName").textContent = fileName;
});
</script>
</body>
</html>
